<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTC导航站</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/md5.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="shortcut icon" href="icons/H.ico" type="image/x-icon">
    <link rel="icon" href="icons/H.ico" type="image/x-icon">
   
</head>
<body>
    <button id="scrollTopBtn" class="scroll-top-btn">
        <i class="fas fa-arrow-up"></i>
    </button>

    <div class="container">
        <!-- 顶部导航 -->
        <header class="header">
            <h1 class="logo">HTC导航站</h1>
        </header>
       
        <!-- 搜索区域 -->
    
        <div class="search-section compact-search">
            <div class="search-engine-tabs">
                <button class="active">必应</button>
                <button>百度</button>
                <button>杨得</button>
            </div>
            <div class="search-box">
                <div class="search-input-group">
                    <input type="text" placeholder="输入关键词搜索...">
                    <a class="translate-button" href="#" title="翻译此内容">
                        <img src="icons/translator.png" alt="翻译" style="height:60%">
                    </a>
                </div>
                <button class="search-button">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>

        <!-- 添加遮罩层和移动翻译卡片到这里 -->
        <div class="translate-overlay"></div>
        <div class="translate-card" style="display:none;">
            <div class="translate-header">
                <div class="language-selector">
                    <select class="source-lang">
                        <option value="auto">自动检测</option>
                        <option value="zh">中文</option>
                        <option value="en">英文</option>
                        <option value="ja">日语</option>
                        <option value="ko">韩语</option>
                        <option value="fr">法语</option>
                        <option value="de">德语</option>
                        <option value="es">西班牙语</option>
                        <option value="ru">俄语</option>
                    </select>
                    <span class="switch-lang">⇄</span>
                    <select class="target-lang">
                        <option value="zh">中文</option>
                        <option value="en">英文</option>
                        <option value="ja">日语</option>
                        <option value="ko">韩语</option>
                        <option value="fr">法语</option>
                        <option value="de">德语</option>
                        <option value="es">西班牙语</option>
                        <option value="ru">俄语</option>
                    </select>
                </div>
            </div>
            <div class="translate-body">
                <textarea class="source-text" placeholder="请输入要翻译的文本"></textarea>
                <button class="translate-start-btn">
                    <i class="fas fa-language"></i>
                    <span>开始翻译</span>
                    <i class="fas fa-spinner" style="display: none;"></i>
                </button>
                <textarea class="target-text" placeholder="翻译结果" readonly></textarea>
            </div>
        </div>

            <!-- 新增分类导航栏 -->
        <div class="category-nav-container">
            <nav class="category-nav">
                <ul>
                    <li class="active">视频资源</li>
                    <li>AI 工具</li>
                    <li>学习资源</li>
                    <li>社交媒体</li>
                    <!-- 可添加更多测试项 -->
                    <li>开发资源</li>
                    <li>MC资源</li>
                    <li>工业控制</li>
                    <li>实用工具</li>
                    <li>软件资源</li>
                </ul>
            </nav>
        </div>
    

           
           <div class="content-area">

                <!-- 其他分类通过JavaScript动态生成 -->

            <script>
                
                        // 新增搜索引擎配置
                        const searchEngines = {
                            "必应": "https://cn.bing.com/search?q={search}",
                            "百度": "https://www.baidu.com/s?wd={search}",
                            "杨得": "https://wap.yandex.com/search/?text={search}&lr=10591"
                        };

                        // 搜索功能实现
                        function handleSearch() {
                        const input = document.querySelector('.search-box input');
                        const keyword = encodeURIComponent(input.value.trim());
                        const engine = document.querySelector('.search-engine-tabs .active').textContent;
                        
                        if (keyword) {
                            const searchUrl = searchEngines[engine].replace('{search}', keyword);
                            window.open(searchUrl, '_blank');
                        }
                         }

                        // 绑定搜索事件（在DOM加载完成后添加）
                        document.addEventListener('DOMContentLoaded', () => {
                            // 搜索按钮点击事件
                            document.querySelector('.search-button').addEventListener('click', handleSearch);
                            
                            // 回车键事件
                            document.querySelector('.search-box input').addEventListener('keypress', (e) => {
                                if (e.key === 'Enter') handleSearch();
                            });

                            // 翻译按钮点击事件
                            const translateButton = document.querySelector('.translate-button');
                            const translateCard = document.querySelector('.translate-card');
                            const translateOverlay = document.querySelector('.translate-overlay');
                            const switchLangButton = document.querySelector('.switch-lang');
                            const sourceText = document.querySelector('.source-text');
                            const searchInput = document.querySelector('.search-box input');
                            
                            translateButton.addEventListener('click', function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                                if(translateCard.style.display === 'none' || !translateCard.style.display) {
                                    translateCard.style.display = 'block';
                                    translateOverlay.classList.add('show');
                                    document.body.style.overflow = 'hidden'; // 防止背景滚动
                                    
                                    // 获取搜索框的文本并填充到翻译输入框
                                    const searchText = searchInput.value.trim();
                                    if (searchText) {
                                        sourceText.value = searchText;
                                        // 自动触发一次翻译
                                        translateStartBtn.click();
                                    }
                                } else {
                                    translateCard.style.display = 'none';
                                    translateOverlay.classList.remove('show');
                                    document.body.style.overflow = '';
                                }
                            });

                            // 点击遮罩层关闭翻译卡片
                            translateOverlay.addEventListener('click', function() {
                                translateCard.style.display = 'none';
                                translateOverlay.classList.remove('show');
                                document.body.style.overflow = '';
                            });

                            // 阻止翻译卡片内部点击事件冒泡
                            translateCard.addEventListener('click', function(e) {
                                e.stopPropagation();
                            });

                            // 语言切换按钮功能
                            switchLangButton.addEventListener('click', function() {
                                const sourceLang = document.querySelector('.source-lang');
                                const targetLang = document.querySelector('.target-lang');
                                const targetText = document.querySelector('.target-text');
                                
                                // 交换语言选择
                                const tempLang = sourceLang.value;
                                sourceLang.value = targetLang.value;
                                targetLang.value = tempLang;
                                
                                // 交换文本内容
                                const tempText = sourceText.value;
                                sourceText.value = targetText.value;
                                targetText.value = tempText;
                            });

                            // 监听源文本变化,自动翻译
                            let translateTimeout;
                            const translateStartBtn = document.querySelector('.translate-start-btn');
                            
                            // 移除原有的自动翻译功能
                            sourceText.addEventListener('input', function() {
                                clearTimeout(translateTimeout);
                            });

                            // 添加翻译按钮点击事件
                            translateStartBtn.addEventListener('click', async function() {
                                const text = sourceText.value.trim();
                                if (!text) return;

                                // 显示加载状态
                                this.classList.add('loading');
                                
                                try {
                                    const sourceLang = document.querySelector('.source-lang').value;
                                    const targetLang = document.querySelector('.target-lang').value;
                                    
                                    const response = await fetch('/.netlify/functions/translate', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify({
                                            text: text,
                                            from: sourceLang,
                                            to: targetLang
                                        })
                                    });
                                    
                                    if (!response.ok) {
                                        throw new Error('翻译请求失败');
                                    }
                                    
                                    const data = await response.json();
                                    document.querySelector('.target-text').value = data.translatedText;
                                } catch (error) {
                                    console.error('翻译错误:', error);
                                    document.querySelector('.target-text').value = '翻译失败,请稍后重试';
                                } finally {
                                    // 移除加载状态
                                    this.classList.remove('loading');
                                }
                            });
                        });

                        // 滚动到顶部功能
                        document.addEventListener('DOMContentLoaded', () => {
                            const scrollBtn = document.getElementById('scrollTopBtn');
                            
                            // 显示/隐藏按钮
                            window.addEventListener('scroll', () => {
                                if (window.scrollY > 200) {
                                    scrollBtn.classList.add('show');
                                } else {
                                    scrollBtn.classList.remove('show');
                                }
                            });

                            // 点击事件
                            scrollBtn.addEventListener('click', () => {
                                window.scrollTo({
                                    top: 0,
                                    behavior: 'smooth'
                                });
                            });
                        });

                        // 保留原有分类相关代码...
 
                // 分类数据（添加标题字段）
                const categories = {
                    "视频资源": {
                        title: "视频",
                        items: [
                            {
                                name: "哔哩哔哩",
                                url: "https://www.bilibili.com",
                                icon: "https://www.bilibili.com/favicon.ico"
                            }
                            ,
                            {
                                name: "抖音",
                                url: "https://www.douyin.com",
                                icon: "https://www.douyin.com/favicon.ico"
                            }
                            ,
                            {
                                name: "好好看",
                                url: "https://dl.hhkan0.com/",
                                icon: "https://vf.wbadl.cn/vod_dl_static_hkan/images/favicon.ico"
                            }
                            
                           
                        ]
                    },
                    "AI 工具": {
                        title: "AI",
                        items: [
                            {
                                name: "deepseek",
                                url: "https://www.deepseek.com/",
                                icon: "https://www.deepseek.com/favicon.ico"
                            }
                            ,
                            {
                                name: "通义千问",
                                url: "https://tongyi.aliyun.com/",
                                icon: "https://img.alicdn.com/imgextra/i4/O1CN01EfJVFQ1uZPd7W4W6i_!!6000000006051-2-tps-112-112.png"
                            }
                            ,
                            {
                                name: "Kimi",
                                url: "https://kimi.moonshot.cn/",
                                icon: "https://statics.moonshot.cn/kimi-chat/favicon.ico"
                            }
                            ,
                            {
                                name: "纳米AI搜索",
                                url: "https://so.n.cn/",
                                icon: "https://so.n.cn/favicon.ico"
                            }
                            ,
                            {
                                name: "硅基流动",
                                url: "https://cloud.siliconflow.cn/models",
                                icon: "https://cloud.siliconflow.cn/favicon.ico"
                            }
                            ,
                            {
                                name: "问小白",
                                url: "https://www.wenxiaobai.com/chat/",
                                icon:"https://www.wenxiaobai.com/new_favicon.ico"
                            }


                        ]
                    },
                    "学习资源": {
                        title: "学习",
                        items: [
                            {
                                name: "Github",
                                url: "https://github.com/",
                                icon: "https://github.com/favicon.ico",
                                text:"知名代码开源平台"
                            }
                            ,
                            {
                                name: "学术导航",
                                url: "https://paper2x.noedgeai.com/",
                                icon: "https://paper2x.noedgeai.com/svg/paper2x.svg",
                                text:"学术文献网站大全"
                            }
                             
                            ,
                            {
                                name: "Docx2",
                                url: "https://doc2x.noedgeai.com/",
                                icon:"https://doc2x.noedgeai.com/assets/doc2x-624ebfe5.svg",
                                text:"文献AI处理"
                            }
                             
                        ]
                    },
                    "社交媒体": {
                        title: "社交媒体",
                        items: [
                            {
                                name: "微博",
                                url: "https://weibo.com/",
                                icon: "https://weibo.com/favicon.ico"
                            }
                            ,
                            {
                                name: "知乎",
                                url: "https://www.zhihu.com/",
                                icon: "https://www.zhihu.com/favicon.ico"
                            }
                             
                            ,
                            {
                                name: "贴吧",
                                url: "https://tieba.baidu.com/",
                                icon: "https://tieba.baidu.com/favicon.ico"
                            }
                
                        ]
                    },  
 
                         


                };

                                       
                        function generateCard(item) {
                            const card = document.createElement('a');
                            card.className = 'website-card';
                            card.href = item.url;
                            card.target = '_blank';
                            card.innerHTML = `
                                <div class="card-header">
                                    ${item.icon ? 
                                        `<img src="${item.icon}" 
                                            class="favicon" 
                                            alt="${item.name}图标"
                                            onerror="this.replaceWith(this.parentNode.querySelector('.link-icon'))">` : 
                                        `<i class="fas fa-link link-icon"></i>`}
                                    <h3>${item.name}</h3>
                                </div>
                                <!-- 新增文本显示逻辑 -->
                                <div class="website-link">
                                    ${item.text ? item.text : item.url} <!-- 关键修改处 -->
                                </div>
                            `;
                            const iconPath = item.icon.startsWith('icons/') ? 
                            item.icon : 
                            `icons/${item.category}/${item.name.toLowerCase()}.png`;
                            return `
                                <div class="card-header">
                                    ${item.icon ? 
                                        `<img src="${iconPath}" 
                                            class="favicon" 
                                            alt="${item.name}图标"
                                            onerror="this.src='icons/default.png'">` : 
                                        `<i class="fas fa-link link-icon"></i>`}
                                    <h3>${item.name}</h3>
                                </div>
                            `;
                            return card;
                        }
                        // 初始化函数（单一版本）
                        function initCategories() {
                            const container = document.querySelector('.content-area');
                            container.innerHTML = '';

                            Object.entries(categories).forEach(([category, data]) => {
                                // 创建分类容器
                                const categoryDiv = document.createElement('div');
                                categoryDiv.className = 'category-content';
                                categoryDiv.dataset.category = category;

                                // 添加分类标题
                                const title = document.createElement('h2');
                                title.textContent = data.title;
                                
                                // 创建卡片网格
                                const cardGrid = document.createElement('div');
                                cardGrid.className = 'card-grid';
                                
                                // 填充卡片
                                data.items.forEach(item => {
                                    cardGrid.appendChild(generateCard(item));
                                });

                                // 组合元素
                                categoryDiv.append(title, cardGrid);
                                container.appendChild(categoryDiv);
                            });

                            // 初始化第一个分类可见
                            document.querySelector('.category-content').classList.add('active');
                        }

                        // 分类导航交互
                        function bindCategoryEvents() {
                            document.querySelectorAll('.category-nav li').forEach(li => {
                                li.addEventListener('click', () => {
                                    // 移除所有active状态
                                    document.querySelectorAll('.category-nav li, .category-content').forEach(el => {
                                        el.classList.remove('active');
                                    });
                                    
                                    // 设置当前active状态
                                    li.classList.add('active');
                                    const targetCategory = li.textContent.trim();
                                    document.querySelector(`[data-category="${targetCategory}"]`).classList.add('active');
                                });
                            });
                        }

                        // 页面初始化
                        document.addEventListener('DOMContentLoaded', () => {
                            initCategories();
                            bindCategoryEvents();
                        });

                   // 生成卡片时使用<a>包裹整个卡片
                        function generateCard(item) {
                            const card = document.createElement('a');
                            card.className = 'website-card';
                            card.href = item.url;
                            card.target = '_blank';
                            card.innerHTML = `
                                <div class="card-header">
                                    ${item.icon ? 
                                        `<img src="${item.icon}" class="favicon" alt="${item.name}图标">` : 
                                        `<i class="fas fa-link link-icon"></i>`}
                                    <h3>${item.name}</h3>
                                </div>
                               <div class="website-link">${item.text || item.url}</div>
                            `;
                            return card;
                        }


                       

                    // 搜索引擎切换
                    document.querySelectorAll('.search-engine-tabs button').forEach(btn => {
                        btn.addEventListener('click', () => {
                            document.querySelector('.search-engine-tabs .active').classList.remove('active');
                            btn.classList.add('active');
                        });
                    });

                    // 在script部分添加滚动功能
                    // 分类导航点击事件
                    document.querySelectorAll('.category-nav li').forEach(li => {
                        li.addEventListener('click', () => {
                            // 移除所有active状态
                            document.querySelectorAll('.category-nav li').forEach(el => {
                                el.classList.remove('active');
                            });
                            li.classList.add('active');
                            
                            // 获取目标分类
                            const targetCategory = li.textContent.trim();
                            const targetSection = document.querySelector(`[data-category="${targetCategory}"]`);
                            
                             // 添加延迟确保DOM更新
                            setTimeout(() => {
                                if(targetSection) {
                                    // 优化后的滚动定位
                                    targetSection.scrollIntoView({
                                        behavior: 'smooth',
                                        block: 'start',
                                        inline: 'nearest'
                                    });

                                    // 优化导航栏滚动定位
                                    const nav = li.closest('ul');
                                    const scrollLeft = li.offsetLeft - (nav.offsetWidth / 2) + (li.offsetWidth / 2);
                                    
                                    nav.parentElement.scrollTo({
                                        left: scrollLeft,
                                        behavior: 'smooth'
                                    });

                                    // 新增滚动修正代码
                                    setTimeout(() => {
                                        const currentPosition = window.scrollY;
                                        const elementPosition = targetSection.offsetTop - 60;
                                        if (Math.abs(currentPosition - elementPosition) > 10) {
                                            window.scrollTo({
                                                top: elementPosition,
                                                behavior: 'smooth'
                                            });
                                        }
                                    }, 300);
                                }
                            }, 50);
                        });
                    });
                    
            </script>
</body>
</html>